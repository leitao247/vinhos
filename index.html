<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Harmonizador Visual</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }
    h1 {
      margin-top: 0;
      margin-bottom: 5px;
    }
    p.sub {
      margin-top: 0;
      color: #555;
      font-size: 14px;
    }
    .container {
      display: flex;
      gap: 20px;
      margin-top: 15px;
    }
    .col {
      flex: 1;
      background: #fff;
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .col h2 {
      margin-top: 0;
      font-size: 18px;
    }
    label {
      font-size: 14px;
    }
    select, input[type="text"] {
      padding: 5px;
      margin: 5px 0;
      width: 100%;
      max-width: 260px;
    }
    button {
      padding: 6px 12px;
      margin: 5px 5px 5px 0;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #bbb;
      background: #fff;
    }
    button.principal {
      background: #007bff;
      color: #fff;
      border-color: #007bff;
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
    .imagem-prato {
      text-align: center;
      margin-top: 10px;
      min-height: 220px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      border: 1px dashed #ccc;
      border-radius: 6px;
      padding: 10px;
      background: #fafafa;
    }
    .imagem-prato img {
      max-width: 100%;
      max-height: 200px;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    .nome-prato {
      font-weight: bold;
      font-size: 16px;
    }
    .status {
      font-size: 13px;
      color: #777;
    }
    .lista-vinhos {
      margin-top: 10px;
      max-height: 280px;
      overflow-y: auto;
      border: 1px solid #eee;
      border-radius: 6px;
      padding: 8px;
      background: #fafafa;
    }
    .vinho-item {
      border-bottom: 1px solid #e0e0e0;
      padding: 6px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .vinho-item:last-child {
      border-bottom: none;
    }
    .vinho-thumb {
      width: 40px;
      height: 60px;
      background: #ddd;
      border-radius: 4px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #666;
    }
    .vinho-info {
      flex: 1;
      font-size: 13px;
    }
    .vinho-nome {
      font-weight: bold;
    }
    .vinho-preco {
      color: #007bff;
    }
    .rodape {
      margin-top: 15px;
      font-size: 12px;
      color: #777;
    }
  </style>
</head>
<body>
  <h1>Harmonizador Visual</h1>
  <p class="sub">Busca prato coerente com o vinho selecionado; mantém preços e layout.</p>

  <div class="container">
    <!-- Lado ESQUERDO: busca de prato e imagem -->
    <div class="col">
      <h2>Prato (TheMealDB – chave pública)</h2>

      <label for="modoBusca">Modo de busca:</label><br>
      <select id="modoBusca">
        <option value="termo">Por termo (ex.: pasta, salmon)</option>
        <option value="categoria">Por categoria (ex.: Beef, Seafood)</option>
      </select><br>

      <label for="termo">Termo ou categoria:</label><br>
      <input type="text" id="termo" placeholder="Ex.: pasta, salmon, beef, seafood">

      <button id="btnBuscar" class="principal">Buscar prato</button>
      <button id="btnAleatorio">Aleatório</button>

      <div class="imagem-prato" id="boxImagem">
        <div class="status" id="statusImagem">Nenhuma imagem carregada<br>Busque um prato para ver a foto aqui</div>
      </div>
    </div>

    <!-- Lado DIREITO: sugestões de vinhos -->
    <div class="col">
      <h2>Sugestões de vinhos</h2>
      <p style="font-size:13px;margin-top:0;">
        Aqui entram os vinhos do seu catálogo, ordenados do menor preço para o maior.
      </p>

      <div class="lista-vinhos" id="listaVinhos">
        <div class="status">Pronto. Selecione um prato e os vinhos serão listados aqui.</div>
      </div>
    </div>
  </div>

  <div class="rodape">
    Mapeamentos vinho → termo, lista padrão e carrinho podem ser adicionados abaixo depois.
  </div>

  <script>
    // =============================
    // CONFIGURAÇÃO DO CATALOGO
    // =============================

    // Por enquanto, alguns vinhos de exemplo.
    // Depois você gera isto a partir da planilha (ordenando por preço).
    const vinhosCatalogo = [
      {
        cod: "300078",
        nome: "PORTA 6 TTO - ARAGONES, CASTELÃO, TOURIGA NACIONAL",
        regiao: "PORTUGAL - LISBOA",
        uvas: ["Aragonez", "Castelão", "Touriga Nacional"],
        preco: 58.70,
        imagem: "" // ex.: "img/porta6_tinto.jpg"
      },
      {
        cod: "300093",
        nome: "PORTA 6 BCO - FERNÃO PIRES, ARINTO, SAUVIGNON BLANC",
        regiao: "PORTUGAL - LISBOA",
        uvas: ["Fernão Pires", "Arinto", "Sauvignon Blanc"],
        preco: 58.70,
        imagem: ""
      },
      {
        cod: "39",
        nome: "RESERVA DOS AMIGOS REGIONAL TTO - ARAGONES, CASTELÃO, TINTA MIUDA",
        regiao: "PORTUGAL - LISBOA",
        uvas: ["Aragonez", "Castelão", "Tinta Miuda"],
        preco: 52.68,
        imagem: ""
      }
    ];

    const modoBusca = document.getElementById("modoBusca");
    const termoInput = document.getElementById("termo");
    const btnBuscar = document.getElementById("btnBuscar");
    const btnAleatorio = document.getElementById("btnAleatorio");
    const boxImagem = document.getElementById("boxImagem");
    const statusImagem = document.getElementById("statusImagem");
    const listaVinhosEl = document.getElementById("listaVinhos");

    // =============================
    // CHAMADAS THEMEALDB
    // =============================

    // Busca por termo no nome do prato
    // https://www.themealdb.com/api/json/v1/1/search.php?s=pasta
    function buscarPorTermo(termo) {
      const url = "https://www.themealdb.com/api/json/v1/1/search.php?s=" + encodeURIComponent(termo);
      return fetch(url).then(r => r.json());
    }

    // Busca por categoria (retorna vários pratos; vamos pegar um aleatório da categoria)
    // https://www.themealdb.com/api/json/v1/1/filter.php?c=Seafood
    function buscarPorCategoria(cat) {
      const url = "https://www.themealdb.com/api/json/v1/1/filter.php?c=" + encodeURIComponent(cat);
      return fetch(url).then(r => r.json());
    }

    // Prato aleatório
    // https://www.themealdb.com/api/json/v1/1/random.php
    function buscarAleatorio() {
      const url = "https://www.themealdb.com/api/json/v1/1/ra

      
